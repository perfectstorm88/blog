
# 概念


- [Docker，Docker Compose，Docker Swarm，Kubernetes（k8s）之间的区别](https://blog.csdn.net/weixin_42117918/article/details/87284670)
- [docker容器下运行tomcat、部署应用](https://blog.csdn.net/shenshucong520/article/details/77947372)
- [Quickstart: Compose and Django](https://docs.docker.com/compose/django/)
- [Docker 私有仓库搭建](https://www.cnblogs.com/huanchupkblog/p/10843800.html)
- [Docker: 上传镜像至私有仓库](https://segmentfault.com/a/1190000017955885)
- [Install Docker Compose](https://docs.docker.com/compose/install/)
- [Docker：Docker Compose 详解](https://www.jianshu.com/p/658911a8cff3)


# 私有仓储实践
## 最简单的本地私有仓储（适合于内网环境）
参考： https://docs.docker.com/registry/deploying/
```bash
# 创建数据卷 docker-repo,用于存储
docker volume create --name docker-repo
docker rm -f registry && \
docker run -d \
  -p 5000:5000 \
  --restart=always \
  --name registry \
  -v docker-repo:/var/lib/registry \
  registry:2
```
[Docker repository server gave HTTP response to HTTPS client](https://stackoverflow.com/questions/49674004)

执行`vim /etc/docker/daemon.json`,然后重启service docker restart
```
"insecure-registries":["10.1.192.120:5000"]
```

## 增加TLS的私有registry
```bash
mkdir -p certs
openssl req \
-subj '/C=CN/ST=ShangHai/L=ShangHai/CN=10.1.192.120' \
-newkey rsa:4096 \
-nodes -sha256 -keyout certs/myrepo.key \
-x509 -days 3650 -out certs/myrepo.crt
```

```
docker run -d \
  -p 5000:5000 \
  --restart=always \
  --name registry \
  -v docker-repo:/var/lib/registry \
  -v "$(pwd)"/certs:/certs \
  -e REGISTRY_HTTP_TLS_CERTIFICATE=/certs/myrepo.crt \
  -e REGISTRY_HTTP_TLS_KEY=/certs/myrepo.key \
  registry:2
```
